<!DOCTYPE html>
<html lang="nl">
	<head>
		<meta charset="UTF-8">

		<title>Add a page</title>

		<%- include ../partials/head -%>

		<%- include ../partials/header -%>

		<% if (feedback) { %>
			<div id="feedback" class="<%= feedbackState %>">
				<%= feedback %>
			</div>
		<% } %>

		<h1>Add a new page</h1>

		<form enctype="multipart/form-data" action="/subterra/pages/add" method="post">
			<fieldset>
				<legend>Type</legend>

				<select name="type">
					<% for (let i = 0; i < system.types.length; i++) { %>
						// Set current page type to selected
						<option value="<%= system.types[i] %>" <%= system.types[i] === page.type ? 'selected' : '' %>>
							<%= system.types[i] %>
						</option>
					<% } %>
				</select>
			</fieldset>
			<fieldset>
				<legend>Title</legend>

				<input type="text" name="title" required>
			</fieldset>
			<fieldset>
				<legend>Menus</legend>

				<ul id="pageMenus"></ul>

				<input name="menus" type="hidden">

				<select id="menuSelect">
					<option value="" disabled selected>Add another menu</option>
					<% for (let i = 0; i < system.menus.length; i++) { %>
						<option value="<%= system.menus[i] %>">
							<%= system.menus[i] %>
						</option>
					<% } %>
				</select>
			</fieldset>
			<fieldset>
				<legend>Content</legend>

				<ul id="pageContent">
					<% for (let i = 0; i < page.content.length; i++) { %>
						<li data-order="<%= i %>">
							<%- page.content[i] %>
							<ul>
							<li><button data-action="move-up" onclick="orderModule('up')">up</button></li>
							<li><button data-action="move-down" onclick="orderModule('down')">down</button></li>
							<li><button data-action="delete" onclick="deleteModule()">delete</button></li>
							</ul>
						</li>
					<% } %>
				</ul>
			</fieldset>
			<fieldset>
				<button id="moduleButton">Add Module</button>

				<select id="moduleSelect" style="display:none;">
					<option value="" disabled selected>Choose a module</option>
					<% for (let i = 0; i < system.modules.length; i++) { %>
						<option value="<%= system.modules[i] %>">
							<%= system.modules[i] %>
						</option>
					<% } %>
				</ul>
			</fieldset>

			<input type="submit" value="Submit">
		</form>

		<p id="systemPages" class="hidden"><%= system.pages %></p>


		<script src="/subterra/assets/script/page.js"></script>

		<%- include ../partials/footer -%>
